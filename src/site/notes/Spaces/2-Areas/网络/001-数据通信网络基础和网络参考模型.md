---
{"dg-publish":true,"permalink":"/Spaces/2-Areas/网络/001-数据通信网络基础和网络参考模型/"}
---

# 一、数据通信网络基础
## 1.常见术语
|术语|说明|
|:-:|:-|
|数据载荷|最终想要传递的信息|
|报文|网络中交换与传输的数据单元|
|头部|在数据载荷的前面添加的信息段|
|尾部|在数据载荷的后面添加的信息段|
|封装|对数据载荷添加头部和尾部，形成新的报文的过程|
|解封装|去掉报文的头部和尾部，获取数据载荷的过程|
|网关|提供协议转换、路由选择、数据交换等功能的网络设备|
|路由器|为报文选择传递路径的网络设备|
|终端设备|数据通信系统的端设备，作为数据的发送者或接收者|
## 2.局域网、城域网、广域网
按照地理覆盖范围来划分，网络可以分为局域网 (Local Area Network)、城域网 (Metropolitan Area Network) 和广域网 (Wide Area Network)。
- 局域网（LAN）：
	- 在某一地理区域内由计算机、服务器以及各种网络设备组成的网络。局域网的覆盖范围一般是方圆几千米以内。
	- 典型的局域网有：一家公司的办公网络，一个网吧的网络，一个家庭网络等。
- 城域网（MAN）：
	- 在一个城市范围内所建立的计算机通信网络。
	- 典型的城域网有：宽带城域网、教育城域网、市级或省级电子政务专网等。
- 广域网（WAN）：
	- 通常覆盖很大的地理范围，从几十公里到几千公里。它能连接多个城市甚至国家，并能提供远距离通信，形成国际性的大型网络。
	- 典型的广域网有：Internet（因特网）。
## 3.网络拓扑
网络拓扑（Network Topology）是指用传输介质（例如双绞线、光纤等）互连各种设备（例如计算机终端、路由器、交换机等）所呈现的结构化布局。

按照网络的拓扑形态来划分，网络可分为星型网络、总线型网络、环形网络、树形网络、全网状网络和部分网状网络。

|网络类型|拓扑图|基本特点|
|:-:|:-:|:-|
|星型网络|![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-22.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-22.png)|所有节点通过一个中心节点连接在一起<br>优点：很容易在网络中增加新的节点。通信数据必须经过中心节点中转，易于实现网络监控<br>缺点：中心节点的故障会影响到整个网络的通信|
|总线型网络|![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-23.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-23.png)|所有节点通过一条总线(如同轴电缆)连接在一起<br>优点：安装简便，节省线缆。某一节点的故障一般不会影响到整个网络的通信<br>缺点：总线故障会影响到整个网络的通信。某一节点发出的信息可以被所有其他节点收到，安全性低|
|环型网络|![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-24.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-24.png)|所有节点连成一个封闭的环形<br>优点：节省线缆<br>缺点：增加新的节点比较麻烦，必须先中断原来的环，才能插入新节点以形成新环|
|树型网络|![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-25.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-25.png)|树型结构实际上是一种层次化的星型结构<br>优点：能够快速将多个星型网络连接在一起，易于扩充网络规模<br>缺点：层级越高的节点故障导致的网络问题越严重|
|全网状网络|![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-26.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-26.png)|所有节点都通过线缆两两互连<br>优点：具有高可靠性和高通信效率<br>缺点：每个节点都需要大量的物理端口，同时还需要大量的互连线缆。成本高，不易扩展|
|部分网状网络|![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-27.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-27.png)|只是重要节点之间才两两互连<br>优点：成本低于全网状网络<br>缺点：可靠性比全网状网络有所降低|

# 二、网络参考模型与标准协议
## 1.OSI参考模型
OSI 模型(Open Systems Interconnection Model)，由国际化标准组织ISO (The International Organization for Standardization ) 收录在ISO 7489标准中并于1984年发布。

|层数|简介|
|:-:|:-|
|7. 应用层|对应用程序提供接口。|
|6. 表示层|进行数据格式的转换，以确保一个系统生成的应用层数据能够被另外一个系统的应用层所识别和理解。|
|5. 会话层|在通信双方之间建立、管理和终止会话。|
|4. 传输层|建立、维护和取消一次端到端的数据传输过程。控制传输节奏的快慢，调整数据的排序等等。|
|3. 网络层|定义逻辑地址；实现数据从源到目的地的转发。|
|2. 数据链路层|将分组数据封装成帧；在数据链路上实现数据的点到点、或点到多点方式的直接通信；差错检测。|
|1. 物理层|在媒介上传输比特流；提供机械的和电气的规约。|

## 2.TCP/IP参考模型
因为OSI协议栈比较复杂，且TCP和IP两大协议在业界被广泛使用，所以TCP/IP参考模型成为了互联网的主流参考模型。
![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-1.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-1.png)
## 3.TCP/IP常见协议
TCP/IP协议栈定义了一系列的标准协议。
![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-2.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-2.png)
- 应用层
	- HTTP（Hypertext Transfer Protocol，超文本传输协议）：用来访问在网页服务器上的各种页面。
	- FTP（File Transfer Protocol，文件传输协议）：为文件传输提供了途径，它允许数据从一台主机传送到另一台主机上。
	- DNS（Domain Name Service，域名称解析服务）：用于实现从主机域名到IP地址之间的转换。
	- FTP（File Transfer Protocol）是一个用于从一台主机传送文件到另一台主机的协议，用于文件的“下载”和“上传”，它采用C/S（Client/Server）结构。
	- Telnet是数据网络中提供远程登录服务的标准协议。 Telnet为用户提供了在本地计算机上完成远程设备工作的能力。
- 传输层
	- TCP （Transmission Control Protocol，传输控制协议） ：为应用程序提供可靠的面向连接的通信服务。目前，许多流行的应用程序都使用TCP。
	- UDP（User Datagram Protocol，用户数据报协议）：提供了无连接通信，且不对传送数据包进行可靠性的保证。
- 网络层
	- [IP（Internet Protocol，互联网协议）](002-网络层协议及IP编址.md)：将传输层的数据封装成数据包并完成源站点到目的站点的转发，提供无连接的、不可靠的服务。
	- IGMP（Internet Group Management Protocol，因特网组管理协议）：负责IP组播成员管理的协议。它用来在IP主机和与其直接相邻的组播路由器之间建立、维护组播组成员关系。 
	- [ICMP（Internet Control Message Protocol，网际报文控制协议）](002-网络层协议及IP编址.md#四、ICMP协议)：基于IP协议在网络中发送控制消息，提供可能发生在通信环境中的各种问题反馈。通过这些信息，使管理者可以对所发生的问题作出诊断，然后采取适当的措施解决。
## 4.常见协议标准化组织
- IETF(Internet Engineering Task Force)
	- 负责开发和推广互联网协议（特别是构成TCP/IP协议族的协议）的志愿组织，通过RFC发布新的或者取代老的协议标准。
- IEEE(Institute of Electrical and Electronics Engineers)
	- IEEE制定了全世界电子、电气和计算机科学领域30%左右的标准，比较知名的有IEEE802.3(Ethernet)、IEEE802.11(WiFi)等。
- ISO(International Organization for Standardization)
	- 在制定计算机网络标准方面，ISO是起着重大作用的国际组织，如OSI模型，定义于ISO/IEC 7498-1。

## 5.应用层
- 应用层为应用软件提供接口，使应用程序能够使用网络服务。应用层协议会指定使用相应的传输层协议，以及传输层所使用的端口等。
- 应用层的PDU被称为Data（数据）。

![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-3.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-3.png)
## 6.传输层
- 传输层协议接收来自应用层协议的数据，封装上相应的传输层头部，帮助其建立“端到端”（Port to Port）的连接。
- 传输层的PDU被称为Segment（段）。

![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-4.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-4.png)
### （1）TCP和UDP - 报文格式
![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-5.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-5.png)

**TCP报文头部：** 
- Source Port：源端口，标识哪个应用程序发送。长度为16比特。  
- Destination Port：目的端口，标识哪个应用程序接收。长度为16比特。  
- Sequence Number：序号字段。TCP链接中传输的数据流每个字节都编上一个序号。序号字段的值指的是本报文段所发送数据的第一个字节的序号。长度为32比特。  
- Acknowledgment Number：确认序列号，是期望收到对方下一个报文段数据的第1个字节的序号，即上次已成功接收到的数据段的最后一个字节数据的序号加1。只有Ack标识为1，此字段有效。长度为32比特。  
- Header Length：头部长度，指出TCP报文头部长度，以32比特（4字节）为计算单位。若无选项内容，则该字段为5，即头部为20字节。  
- Reserved：保留，必须填0。长度为6比特。  
- Control bits：控制位，包含FIN、ACK、SYN等标志位，代表不同状态下的TCP数据段。  
- Window：窗口TCP的流量控制，这个值表明当前接收端可接受的最大的数据总数（以字节为单位）。窗口最大为65535字节。长度为16比特。  
- Checksum：校验字段，是一个强制性的字段，由发端计算和存储，并由收端进行验证。在计算检验和时，要包括TCP头部和TCP数据，同时在TCP报文段的前面加上12字节的伪头部。长度为16比特。
### （2）TCP的建立 - 三次握手
任何基于TCP的应用，在发送数据之前，都需要由TCP进行“三次握手”建立连接。
![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-6.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-6.png)

**TCP连接建立的详细过程如下：**
1. 由TCP连接发起方（图中PC1），发送第一个SYN位置1的TCP报文。初始序列号a为一个随机生成的数字，因为没收到过来自PC2的任何报文，所以确认序列号为0 ；
2. 接收方（图中PC2）接收到合法的SYN报文之后，回复一个SYN和ACK置1的TCP报文。初始序列号b为一个随机生成的数字，同时因为此报文是回复给PC1的报文，所以确认序列号为a+1；
3. PC1接收到PC2发送的SYN和ACK置位的TCP报文后，回复一个ACK置位的报文，此时序列号为a+1,确认序列号为b+1。PC2收到之后，TCP双向连接建立。

### （3）TCP的序列号与确认序列号
TCP使用序列号和确认序列号字段实现数据的可靠和有序传输。
![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-7.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-7.png)
- 假设PC1要给PC2发送一段数据，传输过程如下：
	1. PC1将全部待TCP发送的数据按照字节为单位编上号。假设第一个字节的编号为“a+1”，第二个字节的序号为“a+2”，依次类推。
	2. PC1会把每一段数据的第一个字节的编号作为序列号（Sequence  number），然后将TCP报文发送出去。
	3. PC2在收到PC1发送来的TCP报文后，需要给予确认同时请求下一段数据，如何确定下一段数据呢？序列号( a+1 )+载荷长度=下一段数据的第一个字节的序号（a+1+12）
	4. PC1在收到PC2发送的TCP报文之后，发现确认序列号为“a+1+12” ，说明“a+1”到“a+12”这一段的数据已经被接受，需要从“a+1+12”开始发送。
- 为了提升发送效率，也可以一次性发送多段数据，由接收方统一确认。
### （4）TCP的窗口滑动机制
TCP通过滑动窗口机制来控制数据的传输速率。
![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-8.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-8.png)
1. 在TCP三次握手建立连接时，双方都会通过Window字段告诉对方本端最大能够接受的字节数（也就是缓冲区大小）。
2. 连接建立成功之后，发送方会根据接受方宣告的Window大小发送相应字节数的数据。
3. 接受方接受到数据之后会放在缓冲区内，等待上层应用来取走缓冲的数据。若数据被上层取走，则相应的缓冲空间将被释放。
4. 接收方根据自身的缓存空间大小通告当前的可以接受的数据大小( Window )。
5. 发送方根据接收方当前的Window大小发送相应数量的数据。
### （5）TCP的关闭 - 四次挥手
当数据传输完成，TCP需要通过“四次挥手”机制断开TCP连接，释放系统资源。
![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-9.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-9.png)
TCP支持全双工模式传输数据，这意味着同一时刻两个方向都可以进行数据的传输。在传输数据之前，TCP通过三次握手建立的实际上是两个方向的连接，因此在传输完毕后，两个方向的连接必须都关闭。如图所示：
1. 由PC1发出一个FIN字段置”1 ”的不带数据的TCP段；
2. PC2收到PC1发来的FIN置位的TCP报文后，会回复一个ACK置位的TCP报文。
3. 若PC2也没有需要发送的数据，则直接发送FIN置位的TCP报文。假设此时PC2还有数据要发送，那么当PC2发送完这些数据之后会发送一个FIN置位的TCP报文去关闭连接。
4. PC1收到FIN置位的TCP报文，回复ACK报文，TCP双向连接断开。
## 7.网络层
传输层负责建立主机之间进程与进程之间的连接，而网络层则负责数据从一台主机到另外一台主机之间的传递。
网络层的PDU被称为Packet（包）。
![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-10.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-10.png)
[IPv4( Internet Protocol Version 4)](002-网络层协议及IP编址.md)，简称IP，是目前应用最广泛的网络层协议。
### 网络层协议工作过程
![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-11.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-11.png)
- 当采用IP作为网络层协议时，通信的双方都会被分配到一个“独一无二”的IP地址来标识自己。IP地址可被写成32位的二进制整数值形式，但为了方便人们阅读和分析，它通常被写成点分十进制的形式，即四个字节被分开用十进制表示，中间用点分隔，比如192.168.1.1。
- IP数据包的封装与转发：
	1. 网络层收到上层（如传输层）协议传来的数据时候，会封装一个IP报文头部，并且把源和目的IP地址都添加到该头部中。
	2. 中间经过的网络设备（如路由器），会维护一张指导IP报文转发的“地图”——路由表，通过读取IP数据包的目的地址，查找本地路由表后转发IP数据包。
	3. IP数据包最终到达目的主机，目的主机通过读取目的IP地址确定是否接受并做下一步处理。
- 除了IP协议外，网络层中还有如OSPF、IS-IS、BGP等各种路由协议帮助路由器建立路由表，[ICMP](002-网络层协议及IP编址.md#四、ICMP协议)帮忙进行网络的控制和状态诊断。
## 8.数据链路层
- 数据链路层位于网络层和物理层之间，可以向网络层的IP、IPv6等协议提供服务。数据链路层的PDU被称为Frame（帧）。
- 以太网（Ethernet）是最常见的数据链路层协议。

![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-12.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-12.png)
### （1）以太网与[MAC地址](003-以太网交换基础.md#2.MAC地址)
- 以太网定义
	- 以太网是一种广播式数据链路层协议，支持多点接入。
	- 个人电脑的网络接口遵循的就是以太网标准。
	- 一般情况下，一个广播域对应着一个IP网段。
- 以太网MAC地址
	- MAC (Media Access Control)地址在网络中唯一标识一个网卡，每个网卡都需要且会有唯一的一个MAC地址。
	- MAC用于在一个IP网段内，寻址找到具体的物理设备。
	- 工作在数据链路层的设备。例如以太网交换机，会维护一张MAC地址表，用于指导数据帧转发。
	- MAC地址由48比特（6个字节）长，12位的16进制数字组成。
### （2）地址解析协议 (ARP)
- ARP（Address Resolution Protocol，地址解析协议）是根据IP地址获取数据链路层地址的一个TCP/IP协议。
- ARP是IPv4中必不可少的一种协议，它的主要功能是：
	- 将IP地址解析为MAC地址；
	- 维护IP地址与MAC地址的映射关系的缓存，即ARP表项；
	- 实现网段内重复IP地址的检测。

```mermaid
graph LR
A(Host 1 ARP缓存):::small-->B(ARP请求):::small-->C(Host 2 ARP缓存):::small-->D(ARP响应):::small-->E(Host 1 ARP缓存):::small
classDef small font-size:11px
```
<big>**①Host 1 ARP缓存：**</big>

**Step 1：**
- 在发送数据前，设备会先查找ARP缓存表。
- 如果缓存表中存在对方设备的MAC地址，则直接采用该MAC地址来封装帧，然后将帧发送出去。如果缓存表中不存在相应信息，则通过ARP来获取。

查询缓存表：
```
Host 1>arp -a
Internet Address    Physical Address   Type
```

![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-13.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-13.png)

网络设备一般都有一个ARP缓存（ARP Cache）。ARP缓存用来存放IP地址和MAC地址的关联信息。
在发送数据前，设备会先查找ARP缓存表。如果缓存表中存在对方设备的ARP表项，则直接采用该表项中的MAC地址来封装帧，然后将帧发送出去。如果缓存表中不存在相应信息，则通过发送ARP Request报文来获得它。
学习到的IP地址和MAC地址的映射关系会被放入ARP缓存表中存放一段时间。在有效期内（缺省：180s），设备可以直接从这个表中查找目的MAC地址来进行数据封装，而无需进行ARP查询。过了这段有效期，ARP表项会被自动删除。
如果目标设备位于其他网络，则源设备会在ARP缓存表中查找网关的MAC地址。然后将数据发送给网关。最后网关再把数据转发给目的设备。

<big>**②ARP请求：**</big>

**Step 2：**
- 主机1通过发送ARP Request报文来获取主机2的MAC地址。
- 由于不知道目的MAC地址，因此ARP Request报文内的目的端MAC地址为0。

**Step 3：**
- ARP Request是广播数据帧，因此交换机收到后，会对该帧执行泛洪操作。

![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-14.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-14.png)

主机1的ARP缓存表中不存在主机2的MAC地址，所以主机1会发送ARP Request来获取目的MAC地址。
ARP Request报文封装在以太帧里。帧头中的源MAC地址为发送端主机1的MAC地址。此时，由于主机1不知道主机2的MAC地址，所以目的MAC地址为广播地址FF-FF-FF-FF-FF-FF。
ARP Request报文中包含发送端MAC地址、发送端IP地址、目的端MAC地址、目的端IP地址，其中目的端MAC地址的值为0。ARP Request报文会在整个网络上传播，该网络中所有主机包括网关都会接收到此ARP Request报文。

<big>**③Host 2 ARP缓存：**</big>

**Step 4：**
- 所有的主机接收到该ARP Request报文后，都会检查它的目的端IP地址字段与自身的IP地址是否匹配。
- 主机2发现IP地址匹配，则会将ARP报文中的发送端MAC地址和发送端IP地址信息记录到自己的ARP缓存表中。

查询缓存表：
```
Host 2>arp -a
Internet Address	Physical Address	Type
192.168.1.1         3C-52-82-49-7E-9D	Dynamic
```

![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-15.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-15.png)

所有的主机接收到该ARP Request报文后，都会检查它的目的端IP地址字段与自身的IP地址是否匹配。如果不匹配，则该主机将不会响应该ARP Request报文。如果匹配，则该主机会将ARP请求报文中的发送端MAC地址和发送端IP地址信息记录到自己的ARP缓存表中，然后通过ARP Reply报文进行响应。

<big>**④ARP响应**</big>

**Step 5：**
- 主机2通过发送ARP Reply报文来响应主机1的请求。
- 此时主机2已知主机1的MAC地址，因此ARP Reply是单播数据帧。

**Step 6：**
- 交换机收到该单播数据帧后，会对该帧执行转发操作。

![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-16.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-16.png)
主机2会向主机1回应ARP Reply报文。
ARP Reply报文中的发送端IP地址是主机2自己的IP地址，目的端IP地址是主机1的IP地址，目的端MAC地址是主机1的MAC地址，发送端MAC地址是自己的MAC地址，同时操作类型被设置为Reply。
ARP Reply报文通过单播传送。

<big>**⑤Host 1 ARP缓存**</big>

**Step 7：**
- 主机1收到ARP Reply以后，会检查ARP报文中目的端IP地址字段是否与自己的IP地址匹配。
- 如果匹配，会将ARP报文中的发送端MAC地址和发送端IP地址信息记录到自己的ARP缓存表中。

查询缓存表：
```
Host 1>arp -a
Internet Address	Physical Address	Type
192.168.1.2	48-A4-72-1C-8F-4F	Dynamic
```
![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-17.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-17.png)

主机1收到ARP Reply以后，会检查ARP报文中目的端IP地址字段与自身的IP地址是否匹配。如果匹配，ARP报文中的发送端MAC地址和发送端IP地址会被记录到主机1的ARP缓存表中。
## 9.物理层
- 数据到达物理层之后，物理层会根据物理介质的不同，将数字信号转换成光信号、电信号或者是电磁波信号。
- 物理层的PDU被称为比特流（Bitstream）。

![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-18.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-18.png)
- 双绞线：当今以太网最常见的传输介质，按照抗电磁干扰能力还可以分为：
	- STP-屏蔽双绞线
	- UTP-非屏蔽双绞线
- 光纤传输，按照功能部件可分为：
	- 光纤：光传输介质，简单的说，就是一根玻璃纤维，用于约束光传输的通道。
	- 光模块：将电信号与光信号互转的器件，产生光信号。
- 串口电缆在WAN（Wide Area Network，广域网）中大规模使用，根据WAN线路类型不同，串口电缆在设备上连接的接口类型也不同：异/同步串口、ATM接口、POS接口、CE1/PRI接口等。
- 无线信号的传输可以通过电磁波进行，例如：无线路由器将数据通过调制以电磁波发送出去，移动终端的无线网卡将电磁波解调，得到数据，完成从无线路由器到移动终端的数据传输。
# 三、数据通信过程
## 1.发送方数据封装
![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-19.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-19.png)
## 2.中间网络数据传输
![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-20.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-20.png)
- 一般情况下：
	- 网络中的二层设备（如以太网交换机）只会解封装数据的二层头部，根据二层头部的信息进行相应的“交换”操作。
	- 网络中的三层设备（如路由器）只会解封装到三层头部，并且根据三层头部的信息进行相应的“路由”操作。
	- 注：“交换”和“路由”的详细细节和原则，将会在后面的课程中详细介绍。
## 3.接收方数据解封装
![../../../Extras/Media/media-001-数据通信网络基础和网络参考模型-21.png](/img/user/Extras/Media/media-001-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E5%92%8C%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-21.png)

***
# 参考文献
[1] 华为技术有限公司.网络参考模型[PPT].(2020)[2025-09-12]
[2] 华为技术有限公司.数据通信网络基础[PPT].(2020)[2025-09-13]